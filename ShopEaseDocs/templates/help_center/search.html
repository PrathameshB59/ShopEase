{% extends 'base.html' %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/help_center.css' %}">
{% endblock %}

{% block content %}
<div class="help-container">
    <nav class="breadcrumb">
        <a href="{% url 'help_center:index' %}">Help Center</a>
        <i class="fas fa-chevron-right"></i>
        <span>Search</span>
    </nav>

    <div class="search-header">
        <h1><i class="fas fa-search"></i> Search Help Center</h1>
        {% if query %}
        <p>Results for "{{ query }}"</p>
        {% endif %}

        <div class="help-search">
            <form action="{% url 'help_center:search' %}" method="GET">
                <input type="text" name="q" value="{{ query }}" placeholder="Search help articles..." autofocus>
                <button type="submit"><i class="fas fa-search"></i></button>
            </form>
        </div>
    </div>

    {% if query %}
    <section class="help-section">
        {% if articles %}
        <h2><i class="fas fa-file-alt"></i> Articles ({{ articles|length }})</h2>
        <div class="articles-list">
            {% for article in articles %}
            <a href="{% url 'help_center:article_detail' article.slug %}" class="article-item">
                <div class="article-info">
                    <h3>{{ article.title }}</h3>
                    <p>{{ article.excerpt|truncatewords:25 }}</p>
                    <span class="article-category-small">
                        <i class="{{ article.category.icon }}"></i>
                        {{ article.category.name }}
                    </span>
                </div>
                <i class="fas fa-chevron-right"></i>
            </a>
            {% endfor %}
        </div>
        {% endif %}

        {% if faqs %}
        <h2><i class="fas fa-comments"></i> FAQs ({{ faqs|length }})</h2>
        <div class="faq-list">
            {% for faq in faqs %}
            <div class="faq-item">
                <button class="faq-question" onclick="this.parentElement.classList.toggle('active')">
                    <span>{{ faq.question }}</span>
                    <i class="fas fa-chevron-down"></i>
                </button>
                <div class="faq-answer">
                    {{ faq.answer|linebreaks }}
                </div>
            </div>
            {% endfor %}
        </div>
        {% endif %}

        {% if not articles and not faqs %}
        <div class="empty-state">
            <i class="fas fa-search"></i>
            <h3>No results found</h3>
            <p>Try different keywords or browse the <a href="{% url 'help_center:index' %}">Help Center</a>.</p>
        </div>
        {% endif %}
    </section>
    {% else %}
    <div class="empty-state">
        <i class="fas fa-search"></i>
        <h3>Enter a search term</h3>
        <p>Type in the search box above to find help articles and FAQs.</p>
    </div>
    {% endif %}
</div>
{% endblock %}
